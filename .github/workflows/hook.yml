name: Hook
on:
  push:
    branches:
      - main
  workflow_dispatch:
    inputs:
      arguments:
        description: 'Client JSON Payload'
        type: string
        default: '{}'
        required: true
env:
  Deploy_Eventbridge: false
  Deploy_Glue: true
  Deploy_Lambda: false
  Deploy_SNS: false
  Deploy_SQS: false
  Deploy_SF: false
  Deploy_S3: true
  Deploy_APIGW: true

jobs:
  set-output-job:
    runs-on: ubuntu-latest
    outputs: 
      OCTOPUS_PID: ${{ steps.create-octopus-project.outputs.octopus_pid }}
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Run Python Script to Set Outputs
        id: create-octopus-project
        run: |
          python scripts/set_output.py
          echo "octopus_pid=${OCTOPUS_PID}" >> $GITHUB_ENV

  use-output-job:
    runs-on: ubuntu-latest
    needs: set-output-job
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Use Outputs
        run: |
          echo "Output 1 is: ${{ needs.set-output-job.outputs.OCTOPUS_PID }}"

